---
- name: Check connectivity between nosts in the "{{ group }}" DNS
  hosts: "{{ group }}"
  gather_facts: false
  loop: "{{ groups[group] }}"
  tasks:
    - name: Register ping result from {{ inventory_hostname }}
      command: ping -c 1 "{{ item }}"
      failed_when:
        - router_ping.rc != 0
      register: router_ping
      changed_when: false
      

    #- name: set stats
    #  set_stats:
    #    data:
   #       broken: "{{ item.item }}"
    #  when: item.failed
    #  loop: "{{ router_ping.results }}"
    #  loop_control:
    #    label: "{{ item.item }}"
        
    #- name: Show failures
   #   debug:
    #    msg: "{{ inventory_hostname }} can't ping {{ item.item }}"
   #   when: item.failed
   #   loop: "{{ router_ping.results }}"
  #    loop_control:
  #      label: "{{ item.item }}"
  #    failed_when: item.failed
